<!DOCTYPE html>
<html lang="en">
<head>
  <title>Health chat service - jawrainey</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Placed here rather than footer as we need to display the initial message -->
  <script src="{{ url_for('static', filename='js/jquery.min.js', _external=True) }}"></script>
  <script src="{{ url_for('static', filename='js/bootstrap.min.js', _external=True) }}"></script>
  <script src="{{ url_for('static', filename='js/socket.io.min.js', _external=True) }}"></script>
  <link href="{{ url_for('static', filename='css/bootstrap.min.css', _external=True) }}" rel="stylesheet">
  <link href="{{ url_for('static', filename='css/custom.css', _external=True) }}" rel="stylesheet">
  <script>
  $(document).ready(function() {
      // explicit package upon connection to prevent global namespace use.
      var socket = io.connect('http://' + document.domain + ':' + location.port + '/chat');
      // emits user input data to server.
      $('form#emit').submit(function(event) {
          socket.emit('user', {data: $('#emit_data').val()});
          return false;
      });
      // response sent from server; user message sent to output on screen.
      socket.on('response', function(msg) {
        $("#messages").append("<p>" + msg.data + "</p>");
        $("#messages").scrollTop($("#messages")[0].scrollHeight); // latest message first
      });
  });
  </script>
</head>
<body>
  <div class="container">
    <h1>Health chat service</h1>
    <div id="messages"></div>
  </div>
  <footer class="footer">
    <div class="container">
      <form id="emit" class="form" method="POST" action='#'>
        <textarea id="emit_data" class="form-control" placeholder="Type your response here."></textarea>
        <input type="submit" class="btn btn-default" value="Send">
      </form>
    </div>
  </footer>
</body>
</html>
